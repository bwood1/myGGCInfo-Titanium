<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <meta name="viewport" content="width=320, user-scalable=no">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Login</title>
        <link rel="stylesheet" href="style.css" type="text/css" media="screen"
        title="no title" charset="utf-8">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
        <script src="/js/jquery.cookie.js"></script>
        <script src="js/login.js"></script>
        <script>
        	var isLoggedIn;
        	//gets the username and password and passes them to the authentication method
			function logIn() {
				// isLoggedIn = 1;
				// window.location.href = "index.html";
				var uName = document.getElementById('userNameField').value;
				var pWord = document.getElementById('passwordField').value;
				authenticateMe(uName, pWord);
			}
			
			//checks the response of the authentication request
			function checkResponse(response) {
				
			}
			
			function getCookie(c_name){
				var c_value = document.cookie;
				var c_start = c_value.indexOf(" " + c_name + "=");
				if (c_start == -1)
  				{
					c_value = null;
				}
				else
  				{
  					c_start = c_value.indexOf("=", c_start) + 1;
  					var c_end = c_value.indexOf(";", c_start);
  					if (c_end == -1)
    				{
    					c_end = c_value.length;
    				}
  					c_value = unescape(c_value.substring(c_start,c_end));
  				}
			return c_value;
			}
			
			//generates the authentiacation request returns "yes", "no", or "empty"
			function authenticateMe(uName, pWord) {
				// $("#myFrame").attr('src', "http://10.0.179.202/brandon/request.php?request=login&user=" + uName + "&pass=" + pWord);
				
				var request = new XMLHttpRequest();
				request.onload = function() {
					var content = this.getResponseHeader('Content-Length');
					console.log(content);
				}
				request.onreadystatechange = function(a,b,c) {
					if(request.readyState == 4) {
						// alert('request finished, response: ' + request.responseText);
						// console.log('request finished, response: ', a,b,c);
						if(request.responseText == "no"){
							alert('Username or password incorrect');
						}
						else if(request.responseText == "empty"){
							alert('Must fill out both fields');
						}
						else{
							alert('You have successfully logged in');
							// alert(request.getResponseHeader("Server"));

							// window.location.href = "index.html";
						}
					}
					
				}
				request.open("GET", "http://10.0.179.202/brandon/request.php?request=login&user=" + uName + "&pass=" + pWord, true);
				request.send();
				
				
				
			}
			
			$(document).ready(function() {
				
			});
        </script>
    </head>
    <body>
        <div id="Screen">
            <!-- Banner -->
            <!-- Top content -->
            <div style="padding: 5% 5% 10% 5%">
                <!-- LoginButton -->
                <div id="backDiv">
                    <img width="100%" height="100%" onclick="window.history.back();"
                    src="images/icons.png" alt="backButton">
                    <figcaption>
                        Back
                    </figcaption>
                </div>
                <!-- /LoginButton -->
                <!-- myGGC Banner -->
                <div id="bannerDiv">
                    <img alt="bannerImage" src="images/icons.png" width="100%"
                    height="100%">
                </div>
            </div>
            <!-- /TopContent -->
            <br />
            <br />
            <!-- content -->
            <div id="loginContent" style="text-align: left;">
                <form id="loginForm">
                    <!-- username -->
                    <div>
                        <div id="userNameLabel" class="passwordLabels">
                            User Name:
                        </div>
                        <span style="width: 10%; display: inline-block"></span>
                        <input id="userNameField" type="text" style="width: 30%; display: 
                            inline-block;" />
                    </div>
                    <!-- /username -->
                    <!-- password -->
                    <div>
                        <div id="passwordLabel" class="passwordLabels">
                            Password:
                        </div>
                        <span style="width: 10%; display: inline-block"></span>
                        <input id="passwordField" type="password" style="width: 30%; display: 
                            inline-block;" />
                    </div>
                    <!-- /password -->
                </form>
                <div style="text-align: right; padding-right: 20%">
                    <button id="loginButton" onclick="logIn();">
                        Sign In
                    </button>
                </div>
            </div>
            <!--/content -->
            <!-- <div id="hiddeniFrame" >
            	<iframe id="myFrame" src=""></iframe>
            </div> -->
        </div>
    </body>
</html>